drop schema if exists DISPIELE;
create schema DISPIELE;
drop table if exists DISPIELE.ITEM cascade;
create table DISPIELE.ITEM (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    DISPLAY_NAME VARCHAR(100),
    PRICE DECIMAL NOT NULL,
    STOCK INT,
    CONSTRAINT PK_ITEM PRIMARY KEY (ID)
);
drop table if exists DISPIELE.CUSTOMER cascade;
create table DISPIELE.CUSTOMER (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    EMAIL VARCHAR(255) NOT NULL,
    GENDER INT,
    FIRST_NAME VARCHAR(255) NOT NULL,
    SURENAME VARCHAR(255) NOT NULL,
    COMPANY VARCHAR(100),
    ADRESSLINE VARCHAR(255) NOT NULL,
    POSTAL_CODE VARCHAR(10) NOT NULL,
    CITY VARCHAR(50) NOT NULL,
    COUNTRY VARCHAR(50) NOT NULL,
    PHONE_NUMBER VARCHAR(50),
    CONSTRAINT PK_CUSTOMER PRIMARY KEY (ID)
);
drop table if exists DISPIELE.USER cascade; 
create table DISPIELE.USER (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    USERNAME VARCHAR(20) NOT NULL,
    PASSWORD_HASH VARCHAR(500) NOT NULL,
    EMAIL VARCHAR(255),
    CONSTRAINT PK_USER PRIMARY KEY (ID)
);
drop table if exists DISPIELE.ORDER cascade;
create table DISPIELE.ORDER (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    QUANTITY INT NOT NULL,
    ITEM_ID BIGINT NOT NULL,
    CUSTOMER_ID BIGINT NOT NULL,
    ORDER_DATE DATE NOT NULL,
    ORDER_TIME TIME NOT NULL,
    COMMENT VARCHAR(500),
    FOUND_BY VARCHAR(50),
    PAYED BOOLEAN NOT NULL,
    SHIPPED BOOLEAN NOT NULL,
    TRACKING_NUMBER VARCHAR(255),
    CONSTRAINT PK_ORDER PRIMARY KEY (ID),
    CONSTRAINT FK_ORDER_ON_CUSTOMER FOREIGN KEY (CUSTOMER_ID) REFERENCES DISPIELE.CUSTOMER (ID),
    CONSTRAINT FK_ORDER_ON_ITEM FOREIGN KEY (ITEM_ID) REFERENCES DISPIELE.ITEM (ID)
);
drop table if exists DISPIELE.ORDER_HISTORY cascade;
create table DISPIELE.ORDER_HISTORY (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    C_USER_ID BIGINT NOT NULL,
    ORDER_ID BIGINT NOT NULL,
    ACTION VARCHAR(500) NOT NULL,
    CONSTRAINT PK_ORDER_HISTORY PRIMARY KEY (ID),
    CONSTRAINT FK_ORDER_HISTORY_ON_USER FOREIGN KEY (C_USER_ID) REFERENCES DISPIELE.USER (ID),
    CONSTRAINT FK_ORDER_HISTORY_ON_ORDER FOREIGN KEY (ORDER_ID) REFERENCES DISPIELE.ORDER (ID)
);